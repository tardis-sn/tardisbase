
<!DOCTYPE html>


<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>tardisbase.testing.regression_comparison.compare module &#8212; tardisbase 0.1.dev1+gb6e86c6d8.d20250821 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <script src="../_static/documentation_options.js?v=1f5f436e"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tardisbase.testing.regression_comparison.file_manager module" href="tardisbase.testing.regression_comparison.file_manager.html" />
    <link rel="prev" title="tardisbase.testing.regression_comparison.analyzers module" href="tardisbase.testing.regression_comparison.analyzers.html" />
    <link href="../_static/tardis.css" rel="stylesheet" type="text/css">

  </head><body>
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-53HJHD1BWS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-53HJHD1BWS');
  </script>
  <a href="http://github.com/tardis-sn/tardis"><img style="position: fixed; top: 0px; right: 0; border: 0; z-index: 100000;image-orientation: 90deg;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png" alt="Fork me on GitHub"/></a>

  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-tardisbase.testing.regression_comparison.compare">
<span id="tardisbase-testing-regression-comparison-compare-module"></span><h1>tardisbase.testing.regression_comparison.compare module<a class="headerlink" href="#module-tardisbase.testing.regression_comparison.compare" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="tardisbase.testing.regression_comparison.compare.ReferenceComparer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tardisbase.testing.regression_comparison.compare.</span></span><span class="sig-name descname"><span class="pre">ReferenceComparer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref1_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref2_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refpath1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refpath2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repo_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardisbase/testing/regression_comparison/compare.html#ReferenceComparer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardisbase.testing.regression_comparison.compare.ReferenceComparer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class for comparing reference data between two regression data commits or direct paths.</p>
<p>This class provides functionality to compare HDF5 files, generate visualizations,
and analyze differences between two regression data repo commits or direct directory paths.
It supports directory comparison, HDF5 file analysis, and plot generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref1_hash</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Git commit hash for the first reference dataset, by default None.
Cannot be used together with refpath1.</p></li>
<li><p><strong>ref2_hash</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Git commit hash for the second reference dataset, by default None.
Cannot be used together with refpath2.</p></li>
<li><p><strong>refpath1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Direct path to the first reference directory, by default None.
Cannot be used together with ref1_hash.</p></li>
<li><p><strong>refpath2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Direct path to the second reference directory, by default None.
Cannot be used together with ref2_hash.</p></li>
<li><p><strong>print_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print file paths in comparison output, by default False.</p></li>
<li><p><strong>repo_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Path to the repository containing reference data, by default None.
If None, uses the path specified in CONFIG[‘compare_path’].
Only used when using git hashes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.13)"><strong>AssertionError</strong></a> – If neither git hashes nor direct paths are provided, or if both are provided.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tardisbase.testing.regression_comparison.compare.ReferenceComparer.compare">
<span class="sig-name descname"><span class="pre">compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_diff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardisbase/testing/regression_comparison/compare.html#ReferenceComparer.compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardisbase.testing.regression_comparison.compare.ReferenceComparer.compare" title="Link to this definition">¶</a></dt>
<dd><p>Perform comparison between regression datasets.</p>
<p>This method executes the main comparison workflow, including optional
directory difference printing and HDF5 file comparison. It updates
the internal test_table_dict with comparison results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>print_diff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print detailed directory differences, by default False.
If True, displays a tree-like view of file differences.
Only available when using git hashes and both references are available.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardisbase.testing.regression_comparison.compare.ReferenceComparer.compare_hdf_files">
<span class="sig-name descname"><span class="pre">compare_hdf_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardisbase/testing/regression_comparison/compare.html#ReferenceComparer.compare_hdf_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardisbase.testing.regression_comparison.compare.ReferenceComparer.compare_hdf_files" title="Link to this definition">¶</a></dt>
<dd><p>Discover and compare all HDF5 files in the reference directories.</p>
<p>This method recursively walks through the reference directories,
identifies HDF5 files (.h5, .hdf5), and compares them. When both
paths are available, it compares files that exist in both directories.
When only one path is available, it lists all HDF5 files in that directory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardisbase.testing.regression_comparison.compare.ReferenceComparer.compare_testspectrumsolver_hdf">
<span class="sig-name descname"><span class="pre">compare_testspectrumsolver_hdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">custom_ref1_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_ref2_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardisbase/testing/regression_comparison/compare.html#ReferenceComparer.compare_testspectrumsolver_hdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardisbase.testing.regression_comparison.compare.ReferenceComparer.compare_testspectrumsolver_hdf" title="Link to this definition">¶</a></dt>
<dd><p>Perform comparison for TestSpectrumSolver HDF5 files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>custom_ref1_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Custom path to the first TestSpectrumSolver.h5 file, by default None.
If None, uses the standard path within ref1_path directory (git mode) or
the direct ref1_path (direct path mode).</p></li>
<li><p><strong>custom_ref2_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Custom path to the second TestSpectrumSolver.h5 file, by default None.
If None, uses the standard path within ref2_path directory (git mode) or
the direct ref2_path (direct path mode).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method automatically creates visualization output directories when
the SAVE_COMP_IMG environment variable is set to ‘1’. The comparison
generates specialized plots tailored for spectrum solver data analysis.</p>
<p>Standard file paths (when custom paths are not provided):</p>
<ul class="simple">
<li><p>git mode: <code class="docutils literal notranslate"><span class="pre">tardis/spectrum/tests/test_spectrum_solver/test_spectrum_solver/TestSpectrumSolver.h5</span></code></p></li>
<li><p>direct path mode: uses ref1_path and ref2_path directly</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardisbase.testing.regression_comparison.compare.ReferenceComparer.display_hdf_comparison_results">
<span class="sig-name descname"><span class="pre">display_hdf_comparison_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardisbase/testing/regression_comparison/compare.html#ReferenceComparer.display_hdf_comparison_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardisbase.testing.regression_comparison.compare.ReferenceComparer.display_hdf_comparison_results" title="Link to this definition">¶</a></dt>
<dd><p>Print a formatted summary of all HDF5 comparison results.</p>
<p>This method provides a comprehensive overview of comparison results
for all HDF5 files that were analyzed, displaying key-value pairs
for each file’s comparison statistics.</p>
<p class="rubric">Notes</p>
<p>The output includes information such as:</p>
<ul class="simple">
<li><p>Number of different keys</p></li>
<li><p>Identical keys count</p></li>
<li><p>Keys with same name but different data</p></li>
<li><p>File paths and reference key lists</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardisbase.testing.regression_comparison.compare.ReferenceComparer.generate_graph">
<span class="sig-name descname"><span class="pre">generate_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardisbase/testing/regression_comparison/compare.html#ReferenceComparer.generate_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardisbase.testing.regression_comparison.compare.ReferenceComparer.generate_graph" title="Link to this definition">¶</a></dt>
<dd><p>Generate interactive visualizations of comparison results.</p>
<p>This method creates Plotly bar charts to visualize differences between
reference datasets, supporting two types of comparisons: keys with same
names but different data, and structural key differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>option</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Type of comparison to visualize. Must be one of:
- “different keys same name” : Shows keys with identical names but different data
- “different keys” : Shows structural differences (added/deleted keys)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interactive Plotly figure showing the comparison results.
Returns None if no data matches the specified option.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plotly.graph_objects.Figure or None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If option is not one of the supported values.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For “different keys same name” option:
- Bar colors represent relative difference magnitude using blue color scale
- Hover information includes maximum relative differences and percentages
- Handles NaN and infinite values gracefully</p>
<p>For “different keys” option:
- Green bars represent added keys
- Red bars represent deleted keys
- Random color variations within each category for distinction</p>
<p>If the environment variable SAVE_COMP_IMG is set to ‘1’, the plot will
be saved as a high-resolution PNG file in a comparison_plots directory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardisbase.testing.regression_comparison.compare.ReferenceComparer.get_temp_dir">
<span class="sig-name descname"><span class="pre">get_temp_dir</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardisbase/testing/regression_comparison/compare.html#ReferenceComparer.get_temp_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardisbase.testing.regression_comparison.compare.ReferenceComparer.get_temp_dir" title="Link to this definition">¶</a></dt>
<dd><p>Get the temporary directory path used for file operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The temporary directory path managed by the file manager when using git,
or None when using direct paths.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Path or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardisbase.testing.regression_comparison.compare.ReferenceComparer.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardisbase/testing/regression_comparison/compare.html#ReferenceComparer.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardisbase.testing.regression_comparison.compare.ReferenceComparer.setup" title="Link to this definition">¶</a></dt>
<dd><p>Set up all necessary components for reference comparison.</p>
<p>This method initializes the file manager (if using git), sets up reference files,
creates analyzer and comparator instances, and establishes directory
comparison objects. Must be called before performing any comparisons.</p>
<p class="rubric">Notes</p>
<p>After calling this method, the following attributes will be available:
- ref1_path : Path to the first reference directory
- ref2_path : Path to the second reference directory
- dcmp : Directory comparison object
- file_setup : Configured FileSetup instance
- diff_analyzer : Configured DiffAnalyzer instance
- hdf_comparator : Configured HDFComparator instance</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardisbase.testing.regression_comparison.compare.ReferenceComparer.summarise_changes_hdf">
<span class="sig-name descname"><span class="pre">summarise_changes_hdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardisbase/testing/regression_comparison/compare.html#ReferenceComparer.summarise_changes_hdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardisbase.testing.regression_comparison.compare.ReferenceComparer.summarise_changes_hdf" title="Link to this definition">¶</a></dt>
<dd><p>Analyze and store changes for a specific HDF5 file pair.</p>
<p>This method performs detailed comparison of an HDF5 file between two
reference directories and stores the results in the internal test_table_dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the HDF5 file to compare.</p></li>
<li><p><strong>path1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>Path</em>) – Path to the directory containing the first reference file.</p></li>
<li><p><strong>path2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>Path</em>) – Path to the directory containing the second reference file.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The results are stored in test_table_dict[name] and include:
- Relative path information (when using git)
- All comparison results from HDFComparator
- Lists of keys from both reference files
- Summary statistics about differences</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardisbase.testing.regression_comparison.compare.ReferenceComparer.teardown">
<span class="sig-name descname"><span class="pre">teardown</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardisbase/testing/regression_comparison/compare.html#ReferenceComparer.teardown"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardisbase.testing.regression_comparison.compare.ReferenceComparer.teardown" title="Link to this definition">¶</a></dt>
<dd><p>Clean up temporary files and directories created during comparison.</p>
<p>This method should be called after completing all operations
to ensure proper cleanup of resources. Only needed when using git hashes.</p>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">tardisbase</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compare_commits.html">Visualizing File Changes Across Commits</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tardisbase.html">tardisbase package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">tardisbase</a><ul>
  <li><a href="tardisbase.html">tardisbase package</a><ul>
  <li><a href="tardisbase.testing.html">tardisbase.testing package</a><ul>
  <li><a href="tardisbase.testing.regression_comparison.html">tardisbase.testing.regression_comparison package</a><ul>
      <li>Previous: <a href="tardisbase.testing.regression_comparison.analyzers.html" title="previous chapter">tardisbase.testing.regression_comparison.analyzers module</a></li>
      <li>Next: <a href="tardisbase.testing.regression_comparison.file_manager.html" title="next chapter">tardisbase.testing.regression_comparison.file_manager module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, TARDIS Collaboration.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/api/tardisbase.testing.regression_comparison.compare.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>